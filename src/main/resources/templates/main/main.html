
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../static/css/style.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        body {
            background-color: #f8f9fc;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        #wrapper {
            display: flex;
        }

        .outerSide {
            width: 250px;
        }

        .sidebar {
            background-color: #4e73df;
            display: block;
            top: 0;
            left: 0;
            width: 250px;
            height: 100vh;
            padding-top: 20px;
            color: white;
        }

        .sidebar .nav-link {
            color: white;
        }

        .sidebar .nav-link.active {
            background-color: #2e59d9;
        }

        #content-wrapper {
            padding: 20px;
            display: block;
            float: right;
            width: 100%;
        }

        .card {
            margin-bottom: 20px;
        }

        .chart {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #Logo {
            text-decoration: none;
            color: white;
            font-size: 50px;
            font-family: Arial;
            font-weight: bold;
        }

        #Logo:hover {
            text-decoration: none;

        }

        .sidebar > li {
            text-align: center;
        }

        .topSide {
            width: 100%;
        }

        .rowSide {
            width: 100%;
        }

        .tableBack {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body id="page-top">
<!-- Page Wrapper -->
<div id="wrapper">
    <!-- Sidebar -->
    <div class="outerSide">

        <ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar">
            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center text-decoration-none"
               th:href="@{/main}">
                <div class="sidebar-brand-icon rotate-n-15">
                    <i class="fas fa-laugh-wink"></i>
                </div>
                <div class="row align-items-center">
                    <img src="/images/logos/jibro_logo.png" alt="logo" height="44px">
                    <div class="sidebar-brand-text mx-3" id="Logo">Jibro</div>
                </div>
            </a>
            <!-- Divider -->
            <hr class="sidebar-divider my-0">
            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" th:href="@{/product/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>상품 관리</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{incoming/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>입고 내역</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{ongoing/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>출고 내역</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{stock/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>재고 관리</span>
                </a>
            </li>
            <!-- Divider -->
            <hr class="sidebar-divider">

            <li class="nav-item active">
                <a class="nav-link" th:href="@{/order/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>주문 내역</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{/sales/summary}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>매출 현황</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{/seller/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>판매 업체</span>
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" th:href="@{/vendor/list}">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>협력 업체</span>
                </a>
            </li>
            <hr class="sidebar-divider">
        </ul>
    </div>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">

            <!-- End of Topbar -->

            <!-- Begin Page Content -->
            <div class="container-fluid">
                <!-- Page Heading -->
                <div class="d-sm-flex align-items-center justify-content-between mb-4">
                    <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>

                </div>

                <!-- 상단 -->
                <div class="topSide" style="box-sizing: inherit">


                    <!-- Content Row -->
                    <div class="row justify-content-between">
                        <!-- Earnings (Monthly) Card Example -->
                        <div class="col-xl-4 col-md-6 mb-4">
                            <div class="card border-left-primary shadow h-100 py-2">
                                <div class="card-body" th:onclick="location.href='/incoming/list'">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                입 고
                                            </div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                                <p th:if="${responseDto.todayTotalIncomingCount != null}"
                                                   th:text="${responseDto.todayTotalIncomingCount} + ' 개'"></p>
                                                <p th:if="${responseDto.todayTotalIncomingCount == null}"
                                                   th:text="'오늘 입고가 없습니다'"></p>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Earnings (Annual) Card Example -->
                        <div class="col-xl-4 col-md-6 mb-4">
                            <div class="card border-left-success shadow h-100 py-2">
                                <div class="card-body" th:onclick="location.href='ongoing/list'">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                                출 고
                                            </div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                                <p th:if="${responseDto.todayTotalOngoingCount != null}"
                                                   th:text="${responseDto.todayTotalOngoingCount} + ' 개'"></p>
                                                <p th:if="${responseDto.todayTotalOngoingCount == null}"
                                                   th:text="'오늘 출고가 없습니다.'"></p>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pending Requests Card Example -->
                        <div class="col-xl-4 col-md-6 mb-4">
                            <div class="card border-left-warning shadow h-100 py-2">
                                <div class="card-body" th:onclick="location.href='/order/list'">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                                신규 주문
                                            </div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                                <p th:if="${responseDto.newOrder != null}"
                                                   th:text="${responseDto.newOrder} + ' 건'"/>
                                                <p th:if="${responseDto.newOrder == null}"
                                                   th:text="'신규 주문건이 없습니다.'"/>
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <i class="fas fa-comments fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- Tasks Card Example -->
                        <!--                        <div class="col-xl-3 col-md-6 mb-4">-->
                        <!--                            <div class="card border-left-info shadow h-100 py-2">-->
                        <!--                                <div class="card-body" th:onclick="location.href='stock/list'">-->
                        <!--                                    <div class="row no-gutters align-items-center">-->
                        <!--                                        <div class="col mr-2">-->
                        <!--                                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">-->
                        <!--                                                재고 부족 상품-->
                        <!--                                            </div>-->
                        <!--                                            <div class="row no-gutters align-items-center">-->
                        <!--                                                &lt;!&ndash;                                            <div class="h5 mb-0 font-weight-bold text-gray-800">&ndash;&gt;-->
                        <!--                                                &lt;!&ndash;                                                 <p th:if="${responseDto.warningStockProduct != null}"&ndash;&gt;-->
                        <!--                                                &lt;!&ndash;                                                    th:text="${responseDto.warningStockProduct}"/>&ndash;&gt;-->
                        <!--                                                &lt;!&ndash;                                                <p th:if="${responseDto.warningStockProduct == null}"&ndash;&gt;-->
                        <!--                                                &lt;!&ndash;                                                    th:text=""/>&ndash;&gt;-->

                        <!--                                                &lt;!&ndash;                                            </div>&ndash;&gt;-->
                        <!--                                            </div>-->
                        <!--                                        </div>-->
                        <!--                                        <div class="col-auto">-->
                        <!--                                            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>-->
                        <!--                                        </div>-->
                        <!--                                    </div>-->
                        <!--                                </div>-->
                        <!--                            </div>-->
                        <!--                        </div>-->

                    </div>
                    <!-- rowSide-->
                    <div class="rowSide">

                        <!-- Content Row -->
                        <div class="row justify-content-between align-items-center">
                            <!-- Earnings Overview -->
                            <div class="col-xl-6 col-md-6 mb-6">
                                <div class="chart" style="height: 300px;">
                                    <canvas id="myAreaChart"></canvas>
                                </div>
                            </div>
                            <!-- Revenue Sources -->
                            <!--                     <div class="col-xl-4 col-lg-5"> -->
                            <!--                         <div class="chart"> -->
                            <!--                             <canvas id="myPieChart"></canvas> -->
                            <!--                         </div> -->
                            <!--                     </div> -->
                            <div class="col-xl-6 col-md-6 mb-6">
                                <div class="tableBack" style="height: 300px; overflow-y: scroll;">
                                    <label class="text-xs font-weight-bold text-info text-uppercase mb-1">재 고</label>
                                    <table class="table " style="text-align: center;">
                                        <thead>

                                        <tr>
                                            <th scope="col">번 호</th>
                                            <th scope="col">제품 번호</th>
                                            <th scope="col">재 고</th>
                                            <th scope="col">안전 재고</th>

                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr th:each="product, iterStat : ${responseDto.productList}">
                                            <th th:text="${iterStat.count}"></th>
                                            <td th:text="${product.productId}"></td>
                                            <td th:text="${product.stockCount}"></td>
                                            <td th:text="${product.safetyStock}"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Content -->
        </div>
        <!-- End of Content Wrapper -->
    </div>
</div>
<!-- End of Page Wrapper -->

<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script th:inline="javascript">
      // 서버에서 받은 데이터를 JavaScript 변수에 할당
    var salesList = /*[[${responseDto.salesList}]]*/ [];
	
    // 날짜를 월/일 형식으로 변환하는 함수
    function formatDate(dateString) {
        var date = new Date(dateString);
        var month = date.getMonth() + 1; // getMonth()는 0부터 시작하므로 1을 더해줍니다.
        var day = date.getDate();
        // 한 자리 수인 경우 앞에 0을 추가
        if (month < 10) {
            month = '0' + month;
        }
        return month + '/' + day;
    }
	
	
    // 날짜와 판매량 데이터 추출
    var labels = salesList.map(function(sale) {
        return formatDate(sale.orderDate);
    });

    var data = salesList.map(function(sale) {
        return sale.totalCount;
    });

    // Set up the chart
    var ctx = document.getElementById('myAreaChart').getContext('2d');
    var myAreaChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: salesList[0].product.productId,
                data: data,
                backgroundColor: 'rgba(78, 115, 223, 0.05)',
                borderColor: 'rgba(78, 115, 223, 1)',
            }],
        },
        options: {
            maintainAspectRatio: false,
            scales: {
                x: {
                    time: {
                        unit: 'day' // 날짜별로 나타내므로 'day'로 변경
                    },
                    grid: {
                        display: false,
                        drawBorder: false
                    },
                },
                y: {
                    ticks: {
                        maxTicksLimit: 5,
                    },
                    grid: {
                        color: 'rgb(234, 236, 244)',
                        zeroLineColor: 'rgb(234, 236, 244)',
                        drawBorder: false,
                        borderDash: [2],
                        zeroLineBorderDash: [2]
                    }
                }
            }
        }
    });

    // var ctx = document.getElementById('myPieChart').getContext('2d');
    // var myPieChart = new Chart(ctx, {
    //     type: 'doughnut',
    //     data: {
    //         labels: ['Direct', 'Referral', 'Social'],
    //         datasets: [{
    //             data: [55, 30, 15],
    //             backgroundColor: ['#4e73df', '#1cc88a', '#36b9cc'],
    //             hoverBackgroundColor: ['#2e59d9', '#17a673', '#2c9faf'],
    //             hoverBorderColor: 'rgba(234, 236, 244, 1)',
    //         }],
    //     },
    //     options: {
    //         maintainAspectRatio: false,
    //         tooltips: {
    //             backgroundColor: 'rgb(255, 255, 255)',
    //             bodyFontColor: '#858796',
    //             borderColor: '#dddfeb',
    //             borderWidth: 1,
    //             xPadding: 15,
    //             yPadding: 15,
    //             displayColors: false,
    //             caretPadding: 10,
    //         },
    //         legend: {
    //             display: false
    //         },
    //         cutoutPercentage: 80,
    //     },
    // });
</script>
</body>

</html>
